@page "/"
@using FollowTheMoney.Models
@rendermode InteractiveServer

<PageTitle>FTM</PageTitle>

<h1>FTM</h1>
<p>Welcome to Follow The Money - Search for politicians and organisations below:</p>

<SearchBar OnSearchCompleted="@HandleSearchResults" />

@if (searchResults != null && searchResults.Any())
{
    <div class="results mt-3">
        <h3>Search Results (@searchResults.Count):</h3>
        <div class="list-group">
            @foreach (var politician in searchResults)
            {
                <a href="/politician/@politician.Id" class="list-group-item list-group-item-action text-decoration-none">
                    <h5>@politician.FullName</h5>
                    <p class="mb-1"><strong>Position:</strong> @politician.Position</p>
                    <p class="mb-1"><strong>Electoral Division:</strong> @politician.ElectoralDivision, @politician.State</p>
                    <p class="mb-1"><strong>Term:</strong> @politician.TermStartDate.ToString("yyyy-MM-dd") - @(politician.TermEndDate?.ToString("yyyy-MM-dd") ?? "Present")</p>
                    

                </a>
            }
        </div>
    </div>
}

@code {
    private List<Politician>? searchResults;

    private Task HandleSearchResults(List<Politician> results)
    {
        searchResults = results;
        StateHasChanged();
        return Task.CompletedTask;
    }
}